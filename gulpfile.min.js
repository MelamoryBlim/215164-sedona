"use strict";var gulp=require("gulp"),less=require("gulp-less"),plumber=require("gulp-plumber"),postcss=require("gulp-postcss"),autoprefixer=require("autoprefixer"),server=require("browser-sync").create(),mqpacker=require("css-mqpacker"),minify=require("gulp-csso"),rename=require("gulp-rename"),imagemin=require("gulp-imagemin"),run=require("run-sequence"),del=require("del");gulp.task("style",function(){gulp.src("less/style.less").pipe(plumber()).pipe(less()).pipe(postcss([autoprefixer({browsers:["last 2 versions"]}),mqpacker({sort:!1})])).pipe(gulp.dest("build/css")).pipe(minify()).pipe(rename("style.min.css")).pipe(gulp.dest("build/css")).pipe(server.stream())}),gulp.task("images",function(){return gulp.src("build/img/**/*.{png,jpg,gif}").pipe(imagemin([imagemin.optipng({optimizationlevel:3}),imagemin.jpegtran({progressive:!0})])).pipe(gulp.dest("build/img"))}),gulp.task("serve",function(){server.init({server:"build/",notify:!1,open:!0,cors:!0,ui:!1}),gulp.watch("less/**/*.less",["style"]),gulp.watch("*.html",["html:update"])}),gulp.task("copy",function(){return gulp.src(["fonts/**/*.{woff,woff2}","img/**","js/**","*.html"],{base:"."}).pipe(gulp.dest("build"))}),gulp.task("html:update",function(e){server.reload(),e()}),gulp.task("clean",function(){return del("build")}),gulp.task("build",function(e){run("clean","copy","style","images",e)});